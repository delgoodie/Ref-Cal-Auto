import os
import re
import PySimpleGUI as sg
from docx import Document
import easyio

"\\\\10.122.0.134\\Reflectance Lab\\Reflectance Calibrations\\PermaFlect Targets\\18%PF-0921-4400\\Info.txt"


def ReplaceWord(doc, variable: str, value: str) -> None:
    occurences = []
    for p in doc.paragraphs:
        if re.match("^.*<" + variable + ">.*$", p.text):
            occurences.append(p)
    for t in doc.tables:
        for c in t._cells:
            if re.match("^.*<" + variable + ">.*$", c.text):
                occurences.append(c)
    for s in doc.sections:
        for p in s.header.paragraphs:
            if re.match("^.*<" + variable + ">.*$", p.text):
                occurences.append(p)
        for t in s.header.tables:
            for c in t._cells:
                if re.match("^.*<" + variable + ">.*$", c.text):
                    occurences.append(c)

    for e in occurences:
        e.text = e.text.replace("<" + variable + ">", value)


def getDarkScanPath(day: int, month: int, year: int, instrument: str):
    dark_scan_path = "\\\\lssvr-fs01\\Reflectance Lab\\Reflectance Calibrations\\stray light Summary.xls_files\\"
    datedDarkScans = []
    expr = "^.*" + str(month) + "( |-|_)" + str(day) + "\\1\\0*" + str(year) + ".*$"
    for dir in os.listdir(dark_scan_path):
        if re.match(expr, dir):
            datedDarkScans.append(dir)

    darkScan = ""
    if len(datedDarkScans) > 1:
        for dir in datedDarkScans:
            if re.match("^.*" + str(year) + "\\s*" + instrument + ".*$", dir, re.IGNORECASE):
                darkScan = dir
        if darkScan == "":
            return print("ERROR no dark scans for type: " + instrument)
    elif len(datedDarkScans) == 1:
        darkScan = datedDarkScans[0]
    else:
        return print("ERROR no dark scans for date")

    if darkScan:
        return dark_scan_path + darkScan + "\\Equation1.Sample.Cycle1.Equation1.csv"
    else:
        return print("ERROR invalid dark scan search")


def Execute(path: str):
    root = "C:\\Users\\wdelgiudice\\Downloads\\18%PF-1020-4436 - Copy\\"

    sample = easyio.File(root + "Equation1.Sample.Cycle1.Equation1.csv")
    darkScan = easyio.File(getDarkScanPath(21, 4, 20, "C"))
    template = Document(root + "Ref-Cal-Cert-Template.docx")

    model = "Model"
    serial_number = "18%PF-1020-4436"
    date = "4/7/2021"
    instrument = "B"

    # MS% in column B
    Ms = [float(sample.Read(("B", i))) for i in range(2, 2257)]

    # Mh (Dark Scan) in column H
    Mh = [float(darkScan.Read(("B", i))) for i in range(2, 2257)]

    # Rr from column F
    Rr = [
        0.9730,
        0.9730,
        0.9740,
        0.9740,
        0.9740,
        0.9750,
        0.9750,
        0.9750,
        0.9750,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9790,
        0.9790,
        0.9790,
        0.9790,
        0.9790,
        0.9800,
        0.9800,
        0.9800,
        0.9800,
        0.9800,
        0.9810,
        0.9810,
        0.9810,
        0.9810,
        0.9810,
        0.9820,
        0.9820,
        0.9820,
        0.9820,
        0.9820,
        0.9830,
        0.9830,
        0.9830,
        0.9830,
        0.9830,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9870,
        0.9870,
        0.9870,
        0.9870,
        0.9870,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9890,
        0.9890,
        0.9890,
        0.9890,
        0.9890,
        0.9890,
        0.9890,
        0.9890,
        0.9890,
        0.9890,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9940,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9930,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9920,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9910,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9900,
        0.9890,
        0.9890,
        0.9890,
        0.9890,
        0.9890,
        0.9890,
        0.9890,
        0.9890,
        0.9890,
        0.9890,
        0.9890,
        0.9890,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9880,
        0.9870,
        0.9870,
        0.9870,
        0.9870,
        0.9870,
        0.9870,
        0.9870,
        0.9870,
        0.9870,
        0.9870,
        0.9870,
        0.9870,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9860,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9850,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9840,
        0.9830,
        0.9830,
        0.9830,
        0.9830,
        0.9830,
        0.9830,
        0.9830,
        0.9830,
        0.9830,
        0.9830,
        0.9830,
        0.9830,
        0.9830,
        0.9830,
        0.9830,
        0.9830,
        0.9830,
        0.9820,
        0.9820,
        0.9820,
        0.9820,
        0.9820,
        0.9820,
        0.9820,
        0.9820,
        0.9820,
        0.9820,
        0.9820,
        0.9820,
        0.9820,
        0.9820,
        0.9820,
        0.9820,
        0.9810,
        0.9810,
        0.9810,
        0.9810,
        0.9810,
        0.9810,
        0.9810,
        0.9810,
        0.9810,
        0.9810,
        0.9810,
        0.9800,
        0.9800,
        0.9800,
        0.9800,
        0.9800,
        0.9790,
        0.9790,
        0.9790,
        0.9790,
        0.9790,
        0.9790,
        0.9790,
        0.9790,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9750,
        0.9750,
        0.9750,
        0.9750,
        0.9750,
        0.9750,
        0.9750,
        0.9740,
        0.9740,
        0.9740,
        0.9740,
        0.9740,
        0.9730,
        0.9730,
        0.9730,
        0.9730,
        0.9730,
        0.9730,
        0.9730,
        0.9730,
        0.9720,
        0.9720,
        0.9720,
        0.9720,
        0.9720,
        0.9720,
        0.9720,
        0.9720,
        0.9720,
        0.9720,
        0.9710,
        0.9710,
        0.9710,
        0.9710,
        0.9710,
        0.9710,
        0.9710,
        0.9710,
        0.9710,
        0.9710,
        0.9700,
        0.9700,
        0.9700,
        0.9700,
        0.9700,
        0.9700,
        0.9700,
        0.9700,
        0.9700,
        0.9700,
        0.9690,
        0.9690,
        0.9690,
        0.9690,
        0.9690,
        0.9690,
        0.9690,
        0.9690,
        0.9690,
        0.9690,
        0.9680,
        0.9680,
        0.9680,
        0.9680,
        0.9680,
        0.9680,
        0.9680,
        0.9680,
        0.9680,
        0.9680,
        0.9670,
        0.9670,
        0.9670,
        0.9670,
        0.9670,
        0.9670,
        0.9670,
        0.9670,
        0.9670,
        0.9670,
        0.9660,
        0.9660,
        0.9660,
        0.9660,
        0.9660,
        0.9660,
        0.9660,
        0.9650,
        0.9650,
        0.9650,
        0.9650,
        0.9650,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9650,
        0.9650,
        0.9650,
        0.9650,
        0.9650,
        0.9650,
        0.9650,
        0.9650,
        0.9660,
        0.9660,
        0.9660,
        0.9660,
        0.9660,
        0.9670,
        0.9670,
        0.9670,
        0.9670,
        0.9680,
        0.9680,
        0.9680,
        0.9690,
        0.9690,
        0.9690,
        0.9690,
        0.9700,
        0.9700,
        0.9700,
        0.9710,
        0.9710,
        0.9710,
        0.9720,
        0.9720,
        0.9720,
        0.9720,
        0.9730,
        0.9730,
        0.9730,
        0.9730,
        0.9740,
        0.9740,
        0.9740,
        0.9740,
        0.9740,
        0.9750,
        0.9750,
        0.9750,
        0.9750,
        0.9750,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9780,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9770,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9760,
        0.9750,
        0.9750,
        0.9750,
        0.9750,
        0.9750,
        0.9750,
        0.9750,
        0.9750,
        0.9750,
        0.9750,
        0.9740,
        0.9740,
        0.9740,
        0.9740,
        0.9740,
        0.9740,
        0.9740,
        0.9730,
        0.9730,
        0.9730,
        0.9730,
        0.9730,
        0.9720,
        0.9720,
        0.9720,
        0.9720,
        0.9720,
        0.9720,
        0.9720,
        0.9720,
        0.9710,
        0.9710,
        0.9710,
        0.9710,
        0.9710,
        0.9710,
        0.9710,
        0.9710,
        0.9710,
        0.9710,
        0.9700,
        0.9700,
        0.9700,
        0.9700,
        0.9700,
        0.9700,
        0.9700,
        0.9690,
        0.9690,
        0.9690,
        0.9690,
        0.9690,
        0.9680,
        0.9680,
        0.9680,
        0.9680,
        0.9680,
        0.9670,
        0.9670,
        0.9670,
        0.9670,
        0.9670,
        0.9660,
        0.9660,
        0.9660,
        0.9660,
        0.9660,
        0.9660,
        0.9660,
        0.9660,
        0.9650,
        0.9650,
        0.9650,
        0.9650,
        0.9650,
        0.9650,
        0.9650,
        0.9650,
        0.9650,
        0.9650,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9640,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9630,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9620,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9610,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
        0.9600,
    ]

    Corrected = [((Ms[i] * 0.01 - Mh[i] * 0.01) / (1 - Mh[i] * 0.01)) * Rr[i] for i in range(2250)]

    txt = open(root + model + ".txt", "w")
    string = serial_number + "\nThis data is for reference only\n"
    for i in range(2250):
        string += "{0}\t{1}\n".format(str(i + 250), str(Corrected[i]))
    txt.write(string)

    ReplaceWord(template, "sn", serial_number)
    ReplaceWord(template, "model", model)
    ReplaceWord(template, "DATE", date)
    ReplaceWord(template, "isA", "X" if instrument in "aA" else "")
    ReplaceWord(template, "isB", "X" if instrument in "bB" else "")
    ReplaceWord(template, "isC", "X" if instrument in "cC" else "")

    for i in range(25, 251, 5):
        ReplaceWord(template, "w" + str(i), str(round(Corrected[i * 10 - 250 - 1] * 1e4) / 1e4))

    template.save(root + "Cert.docx")
    return True


def main() -> None:
    layout = [[sg.FolderBrowse(), sg.Text("Select Folder")], [sg.Button("Execute")], [sg.Text(key="error_message", size=(20, 2))]]
    window = sg.Window(title="Micrsoft Office Generator", layout=layout, margins=(125, 50))
    while True:
        event, values = window.read()

        if event == "Execute" and values["Browse"]:
            result = Execute(values["Browse"] + "/")
            if result is True:
                break
            else:
                window["error_message"].update(result)
        if event == sg.WIN_CLOSED:
            break
    window.close()


# main()
Execute("gdsgr")
